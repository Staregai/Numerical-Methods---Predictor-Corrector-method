b2m=2;
fileID = 1;

fprintf(fileID , '%s\n' , "Sprawdzenie wpływu zmiany proporcji wykonanych predykcji do korekcji");
fprintf(fileID , '%s\n' , "w metodzie Addamsa-Bashfortha-Moultona na błąd globalny i rząd metody");
fprintf(fileID , '%s\n' , "dla kilku wybranych funkcji i n = 4^6");

pause;

fprintf(fileID , '%s\n' , "równanie 1");
ex=(3^(2/3) - 1)*3;
fprintf(fileID , '%s\n' , "równanie: @(x) 5*x^2*y''(x) - 5*x*y'(x) + 5*y(x) = 0");                                                                                                                                                                                                                           
fprintf(fileID , '%s\n' , "Warunki początkowe: y(1) = 0 , y'(1) = 2/3");
fprintf(fileID , '%s\n' , "rozwiązanie równania y(x) = (x^(2/3) - 1)*x");
fprintf(fileID , '%s %f\n' , "Obliczana wartośc: y(3) = " ,ex);

[x , y , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^0);
[x , y1 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^1);
[x , y2 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^2);
[x , y3 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^3);
[x , y4 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^4);
[x , y5 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^5);
[x , y6 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^6);
[x , y7 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^7);
[x , y8 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^8);
[x , y9 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^6 , 1, b2m^9);
[x , y51 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^1);
[x , y52 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^2);
[x , y53 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^3);
[x , y54 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^4);
[x , y55 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^5);
[x , y56 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^6);
[x , y57 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^7);
[x , y58 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^8);
[x , y59 , dy , ddy]=P1Z12_IST_prekor(@(x)5 , @(x) - 5*x , @(x)3*x^2 , @(x)0 , 0 , 2/3 , 1 , 3 , 4^5 , 1, b2m^9);

erG1=abs(ex - y1(4^6+1));
erG2=abs(ex - y2(4^6+1));
erG3=abs(ex - y3(4^6+1));
erG4=abs(ex - y4(4^6+1));
erG5=abs(ex - y5(4^6+1));
erG6=abs(ex - y6(4^6+1));
erG7=abs(ex - y7(4^6+1));
erG8=abs(ex - y8(4^6+1));
erG9=abs(ex - y9(4^6+1));
erG51=abs(ex - y51(4^5+1));
erG52=abs(ex - y52(4^5+1));
erG53=abs(ex - y53(4^5+1));
erG54=abs(ex - y54(4^5+1));
erG55=abs(ex - y55(4^5+1));
erG56=abs(ex - y56(4^5+1));
erG57=abs(ex - y57(4^5+1));
erG58=abs(ex - y58(4^5+1));
erG59=abs(ex - y59(4^5+1));
erG = abs(ex - y(4^6+1));

fprintf(fileID , '\t%7s %7s  %13s %13s\n' , "b2m" , "błąd" , "rząd metody" , "przesunięcie błędu");
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^1" , erG1 , log(erG51/erG1)/log(4) , erG-erG1);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^2" , erG2 , log(erG52/erG2)/log(4) , erG-erG2);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^3" , erG3 , log(erG53/erG3)/log(4) , erG-erG3);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^4" , erG4 , log(erG54/erG4)/log(4) , erG-erG4);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^5" , erG5 , log(erG55/erG5)/log(4) , erG-erG5);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^6" , erG6 , log(erG56/erG6)/log(4) , erG-erG6);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^7" , erG7 , log(erG57/erG7)/log(4) , erG-erG7);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^8" , erG8 , log(erG58/erG8)/log(4) , erG-erG8);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n\n' , "2^9" , erG9 , log(erG59/erG9)/log(4) , erG-erG9);

pause;

fprintf(fileID , '%s\n' , "równanie 2");
ex=125;
fprintf(fileID , '%s\n' , "równanie: @(x) x*y''(x) + (x^3 - 8)*y(x)");
fprintf(fileID , '%s\n' ,   "- (x^2 + 3)*y(x) = 6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2");
fprintf(fileID , '%s\n' , "Warunki początkowe: y(2) = 8 , y'(2) = 12");
fprintf(fileID , '%s\n' , "rozwiązanie równania y(x) = x^3");
fprintf(fileID , '%s\n' , "Obliczana wartośc: y(5) = 125");

[x , y , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^0);
[x , y1 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^1);
[x , y2 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^2);
[x , y3 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^3);
[x , y4 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^4);
[x , y5 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^5);
[x , y6 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^6);
[x , y7 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^7);
[x , y8 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^8);
[x , y9 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^6 , 1, b2m^9);
[x , y51 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^1);
[x , y52 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^2);
[x , y53 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^3);
[x , y54 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^4);
[x , y55 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^5);
[x , y56 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^6);
[x , y57 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^7);
[x , y58 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^8);
[x , y59 , dy , ddy]=P1Z12_IST_prekor(@(x) - x^2 - 3 , @(x)x^3 - 8 , @(x)x , @(x)6*x^2 - (x^2 + 3) *x^3 + 3*(x^3 - 8)*x^2 , 8 , 12 , 2 , 5 , 4^5 , 1, b2m^9);

erG1=abs(ex - y1(4^6+1));
erG2=abs(ex - y2(4^6+1));
erG3=abs(ex - y3(4^6+1));
erG4=abs(ex - y4(4^6+1));
erG5=abs(ex - y5(4^6+1));
erG6=abs(ex - y6(4^6+1));
erG7=abs(ex - y7(4^6+1));
erG8=abs(ex - y8(4^6+1));
erG9=abs(ex - y9(4^6+1));
erG51=abs(ex - y51(4^5+1));
erG52=abs(ex - y52(4^5+1));
erG53=abs(ex - y53(4^5+1));
erG54=abs(ex - y54(4^5+1));
erG55=abs(ex - y55(4^5+1));
erG56=abs(ex - y56(4^5+1));
erG57=abs(ex - y57(4^5+1));
erG58=abs(ex - y58(4^5+1));
erG59=abs(ex - y59(4^5+1));
erG = abs(ex - y(4^6+1));

fprintf(fileID , '\t%7s %7s  %13s %13s\n' , "b2m" , "błąd" , "rząd metody" , "przesunięcie błędu");
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^1" , erG1 , log(erG51/erG1)/log(4) , erG-erG1);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^2" , erG2 , log(erG52/erG2)/log(4) , erG-erG2);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^3" , erG3 , log(erG53/erG3)/log(4) , erG-erG3);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^4" , erG4 , log(erG54/erG4)/log(4) , erG-erG4);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^5" , erG5 , log(erG55/erG5)/log(4) , erG-erG5);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^6" , erG6 , log(erG56/erG6)/log(4) , erG-erG6);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^7" , erG7 , log(erG57/erG7)/log(4) , erG-erG7);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^8" , erG8 , log(erG58/erG8)/log(4) , erG-erG8);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n\n' , "2^9" , erG9 , log(erG59/erG9)/log(4) , erG-erG9);
pause;

fprintf(fileID , '%s\n' , "równanie 3");
ex=3^5;
fprintf(fileID , '%s\n' , "równanie: @(x) x^(1/2)*y''(x) - (2/x)*y'(x) + x^2*y(x)");
fprintf(fileID , '%s\n' , " = x^4 - 5*x^2 + 2/x - 4");
fprintf(fileID , '%s\n' , "Warunki początkowe: y(1) = -4 , y'(1) = 3*log(3)");
fprintf(fileID , '%s\n' , "rozwiązanie równania y(x) = 3^x");
fprintf(fileID , '%s %f\n' , "Obliczana wartośc: y(5) =" , ex);

[x , y , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^0);
[x , y1 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^1);
[x , y2 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^2);
[x , y3 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^3);
[x , y4 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^4);
[x , y5 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^5);
[x , y6 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^6);
[x , y7 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^7);
[x , y8 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^8);
[x , y9 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^6 , 1, b2m^9);
[x , y51 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^1);
[x , y52 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^2);
[x , y53 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^3);
[x , y54 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^4);
[x , y55 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^5);
[x , y56 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^6);
[x , y57 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^7);
[x , y58 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^8);
[x , y59 , dy , ddy]=P1Z12_IST_prekor(@(x)x^2 , @(x)-2/x , @(x)x^(1/2) , @(x)(-(2/x)*log(3) + x^(1/2)*log(3)^2 + x^2)*3^x , 3 , 3*log(3) , 1 , 5 , 4^5 , 1, b2m^9);

erG1=abs(ex - y1(4^6+1));
erG2=abs(ex - y2(4^6+1));
erG3=abs(ex - y3(4^6+1));
erG4=abs(ex - y4(4^6+1));
erG5=abs(ex - y5(4^6+1));
erG6=abs(ex - y6(4^6+1));
erG7=abs(ex - y7(4^6+1));
erG8=abs(ex - y8(4^6+1));
erG9=abs(ex - y9(4^6+1));
erG51=abs(ex - y51(4^5+1));
erG52=abs(ex - y52(4^5+1));
erG53=abs(ex - y53(4^5+1));
erG54=abs(ex - y54(4^5+1));
erG55=abs(ex - y55(4^5+1));
erG56=abs(ex - y56(4^5+1));
erG57=abs(ex - y57(4^5+1));
erG58=abs(ex - y58(4^5+1));
erG59=abs(ex - y59(4^5+1));
erG = abs(ex - y(4^6+1));

fprintf(fileID , '\t%7s %7s  %13s %13s\n' , "b2m" , "błąd" , "rząd metody" , "przesunięcie błędu");
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^1" , erG1 , log(erG51/erG1)/log(4) , erG-erG1);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^2" , erG2 , log(erG52/erG2)/log(4) , erG-erG2);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^3" , erG3 , log(erG53/erG3)/log(4) , erG-erG3);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^4" , erG4 , log(erG54/erG4)/log(4) , erG-erG4);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^5" , erG5 , log(erG55/erG5)/log(4) , erG-erG5);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^6" , erG6 , log(erG56/erG6)/log(4) , erG-erG6);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^7" , erG7 , log(erG57/erG7)/log(4) , erG-erG7);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^8" , erG8 , log(erG58/erG8)/log(4) , erG-erG8);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n\n' , "2^9" , erG9 , log(erG59/erG9)/log(4) , erG-erG9);

pause;

fprintf(fileID , '%s\n' , "równanie 4");
ex=sin(2*pi);
fprintf(fileID , '%s\n' , "równanie: @(x) x^3*y''(x) +x^2*y'(x) + x*y(x) =");
fprintf(fileID , '%s\n' , " = x^2*cos(x) - x^3*sin(x) + x*sin(x)");
fprintf(fileID , '%s\n' , "Warunki początkowe: y(pi/4)=(2^(1/2))/2 , y'(pi/4)=(2^(1/2))/2");
fprintf(fileID , '%s\n' , "rozwiązanie równania y(x) = sin(x)");
fprintf(fileID , '%s %f\n' , "Obliczana wartośc: y(2*pi) =" , ex);

[x1 , y , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^0);
[x1 , y1 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^1);
[x2 , y2 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^2);
[x3 , y3 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^3);
[x4 , y4 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^4);
[x5 , y5 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^5);
[x6 , y6 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^6);
[x7 , y7 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^7);
[x8 , y8 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^8);
[x9 , y9 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^6 , 1, b2m^9);
[x1 , y51 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^1);
[x2 , y52 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^2);
[x3 , y53 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^3);
[x4 , y54 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^4);
[x5 , y55 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^5);
[x6 , y56 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^6);
[x7 , y57 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^7);
[x8 , y58 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^8);
[x9 , y59 , dy , ddy]=P1Z12_IST_prekor(@(x)x , @(x)x^2 , @(x)x^3 , @(x)x^2*cos(x) - x^3*sin(x) + x*sin(x) , (2^(1/2))/2 , (2^(1/2))/2 , pi/4 , 2*pi , 4^5 , 1, b2m^9);

erG1=abs(ex - y1(4^6+1));
erG2=abs(ex - y2(4^6+1));
erG3=abs(ex - y3(4^6+1));
erG4=abs(ex - y4(4^6+1));
erG5=abs(ex - y5(4^6+1));
erG6=abs(ex - y6(4^6+1));
erG7=abs(ex - y7(4^6+1));
erG8=abs(ex - y8(4^6+1));
erG9=abs(ex - y9(4^6+1));
erG51=abs(ex - y51(4^5+1));
erG52=abs(ex - y52(4^5+1));
erG53=abs(ex - y53(4^5+1));
erG54=abs(ex - y54(4^5+1));
erG55=abs(ex - y55(4^5+1));
erG56=abs(ex - y56(4^5+1));
erG57=abs(ex - y57(4^5+1));
erG58=abs(ex - y58(4^5+1));
erG59=abs(ex - y59(4^5+1));
erG = abs(ex - y(4^6+1));

fprintf(fileID , '\t%7s %7s  %13s %13s\n' , "b2m" , "błąd" , "rząd metody" , "przesunięcie błędu");
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^1" , erG1 , log(erG51/erG1)/log(4) , erG-erG1);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^2" , erG2 , log(erG52/erG2)/log(4) , erG-erG2);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^3" , erG3 , log(erG53/erG3)/log(4) , erG-erG3);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^4" , erG4 , log(erG54/erG4)/log(4) , erG-erG4);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^5" , erG5 , log(erG55/erG5)/log(4) , erG-erG5);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^6" , erG6 , log(erG56/erG6)/log(4) , erG-erG6);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^7" , erG7 , log(erG57/erG7)/log(4) , erG-erG7);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^8" , erG8 , log(erG58/erG8)/log(4) , erG-erG8);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n\n' , "2^9" , erG9 , log(erG59/erG9)/log(4) , erG-erG9);
pause;

fprintf(fileID , '%s\n' , "równanie 5");
ex=log(5);
fprintf(fileID , '%s\n' , "równanie: @(x) x^(1/2)*y''(x) +x^(1/3)*y'(x) + x^(1/4)*y(x) =");
fprintf(fileID , '%s\n' , " = -x^-(3/2) + x^-(2/3) + x^(1/4)*log(x)");
fprintf(fileID , '%s\n' , "Warunki początkowe: y(1)=0 , y'(1)=1)");
fprintf(fileID , '%s\n' , "rozwiązanie równania y(x) = log(x)");
fprintf(fileID , '%s %f\n' , "Obliczana wartośc: y(5) =" , ex);

[x , y , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^0);
[x , y1 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^1);
[x , y2 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^2);
[x , y3 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^3);
[x , y4 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^4);
[x , y5 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^5);
[x , y6 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^6);
[x , y7 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^7);
[x , y8 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^8);
[x , y9 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^6 , 1, b2m^9);
[x , y51 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^1);
[x , y52 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^2);
[x , y53 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^3);
[x , y54 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^4);
[x , y55 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^5);
[x , y56 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^6);
[x , y57 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^7);
[x , y58 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^8);
[x , y59 , dy , ddy]=P1Z12_IST_prekor(@(x)x^(1/4) , @(x)x^(1/3) , @(x)x^(1/2) , @(x)-x^-(3/2) + x^-(2/3) + x^(1/4)*log(x) , 0 , 1 , 1 , 5 , 4^5 , 1, b2m^9);


erG1=abs(ex - y1(4^6+1));
erG2=abs(ex - y2(4^6+1));
erG3=abs(ex - y3(4^6+1));
erG4=abs(ex - y4(4^6+1));
erG5=abs(ex - y5(4^6+1));
erG6=abs(ex - y6(4^6+1));
erG7=abs(ex - y7(4^6+1));
erG8=abs(ex - y8(4^6+1));
erG9=abs(ex - y9(4^6+1));
erG51=abs(ex - y51(4^5+1));
erG52=abs(ex - y52(4^5+1));
erG53=abs(ex - y53(4^5+1));
erG54=abs(ex - y54(4^5+1));
erG55=abs(ex - y55(4^5+1));
erG56=abs(ex - y56(4^5+1));
erG57=abs(ex - y57(4^5+1));
erG58=abs(ex - y58(4^5+1));
erG59=abs(ex - y59(4^5+1));
erG = abs(ex - y(4^6+1));

fprintf(fileID , '\t%7s %7s  %13s %13s\n' , "b2m" , "błąd" , "rząd metody" , "przesunięcie błędu");
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^1" , erG1 , log(erG51/erG1)/log(4) , erG-erG1);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^2" , erG2 , log(erG52/erG2)/log(4) , erG-erG2);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^3" , erG3 , log(erG53/erG3)/log(4) , erG-erG3);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^4" , erG4 , log(erG54/erG4)/log(4) , erG-erG4);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^5" , erG5 , log(erG55/erG5)/log(4) , erG-erG5);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^6" , erG6 , log(erG56/erG6)/log(4) , erG-erG6);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^7" , erG7 , log(erG57/erG7)/log(4) , erG-erG7);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n' , "2^8" , erG8 , log(erG58/erG8)/log(4) , erG-erG8);
fprintf(fileID , '\t%7s\t %1.3e   %4f\t %1.3e\n\n' , "2^9" , erG9 , log(erG59/erG9)/log(4) , erG-erG9);
